# 第 4 章 虚拟机的安装和使用

|本期版本|上期版本|
|:---:|:---:|
|`Wed Dec 28 11:43:22 CST 2022` | - |

## 4.1 计算机的启动过程

### 4.1.2 计算机的加电和复位

* 对于 Intel 8086 来说，复位将使代码段寄存器(CS)的内容为 `0xFFFF`, 其他所有寄存器的内容为 `0x0000`
* **8086 之后的处理器并未延续这种设计**

### 4.1.5 一切从主引导扇区开始

* 硬盘的第一个扇区是 0 面 0 道 1 扇区，或者说是 0 头 0 柱 1 扇区，这个扇区称为 `主引导扇区`
* ROM-BIOS 将读取主引导扇区的内容，将它加载到内存地址  `0x0000:0x7c00`

```nasm
jmp 0x0000:0x7c00
```

## 4.2 创建和使用虚拟机

### 4.2.3  虚拟硬盘简介

* 硬盘的读写是以扇区为最小单位的。所以无论什么时候，要从硬盘读数据，或者向硬盘写数据，至少得是 1 个扇区

```bash
# 4MB = 4 * 1024 * 1024 = 4194816D = 0400200H
# 4194816 - 512 = 4194304

VBoxManage createmedium disk --filename demo --format VHD --variant Fixed --size 4
hexdump -s 4194304 -n 512 -C demo.vhd
```

### 4.2.4 练习使用 FixVhdWr 工具向虚拟硬盘写入数据

```bash
dd if=mbr.bin of=c.img bs=512 count=1 seek=100 conv=notrunc
```